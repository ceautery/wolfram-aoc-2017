Notebook[{Cell[
CellGroupData[{Cell[
BoxData[RowBox[{"neighborTable"," ","="," ",RowBox[
{"Flatten","[",RowBox[{RowBox[{"Table","[",RowBox[{RowBox[{"{",RowBox[{RowBox[{"x"," ","-"," ","2"}],","," ",RowBox[
{"y"," ","-"," ","2"}]}],"}"}],","," ",RowBox[{"{",RowBox[{"y",","," ","3"}],"}"}],","," ",RowBox[
{"{",RowBox[{"x",",","3"}],"}"}]}],"]"}],","," ","1"}],"]"}]}]],"Input",CellID->287,
CellLabel->"In[1]:= "],Cell[
BoxData[RowBox[{"{",RowBox[{RowBox[{"{",RowBox[{RowBox[
{"-","1"}],",",RowBox[{"-","1"}]}],"}"}],",",RowBox[{"{",RowBox[{"0",",",RowBox[{"-","1"}]}],"}"}],",",RowBox[
{"{",RowBox[{"1",",",RowBox[{"-","1"}]}],"}"}],",",RowBox[{"{",RowBox[{RowBox[{"-","1"}],",","0"}],"}"}],",",RowBox[
{"{",RowBox[{"0",",","0"}],"}"}],",",RowBox[{"{",RowBox[{"1",",","0"}],"}"}],",",RowBox[
{"{",RowBox[{RowBox[{"-","1"}],",","1"}],"}"}],",",RowBox[{"{",RowBox[{"0",",","1"}],"}"}],",",RowBox[
{"{",RowBox[{"1",",","1"}],"}"}]}],"}"}],StandardForm],"Output",CellID->33,CellLabel->"Out[1]= "]},
Open]],Cell[
BoxData[RowBox[{RowBox[{"neighbors","[","vertex_","]"}]," ",":="," ",RowBox[
{RowBox[{RowBox[{"vertex"," ","+"," ","#"}]," ","&"}]," ","/@"," ","neighborTable"}]}]],
"Input",CellID->293,CellLabel->"In[2]:= "],Cell[
CellGroupData[{Cell[
BoxData[RowBox[
{"graphCoords"," ","="," ",RowBox[{RowBox[{RowBox[{"#"," ","+"," ",RowBox[{"{",RowBox[
{"1",",","1"}],"}"}]}],"&"}]," ","/@"," ",RowBox[{"(",RowBox[{RowBox[{"VertexCoordinates"," ","/."," ",RowBox[
{"AbsoluteOptions","[",RowBox[{"PathGraph","[",RowBox[{"Range","[","71","]"}],"]"}],"]"}]}]," ","//"," ","IntegerPart"}],")"}]}]}]],
"Input",CellID->294,CellLabel->"In[3]:= "],Cell[
BoxData[RowBox[{"{",RowBox[{RowBox[
{"{",RowBox[{"5",",","4"}],"}"}],",",RowBox[{"{",RowBox[{"6",",","4"}],"}"}],",",RowBox[
{"{",RowBox[{"6",",","5"}],"}"}],",",RowBox[{"{",RowBox[{"5",",","5"}],"}"}],",",RowBox[
{"{",RowBox[{"4",",","5"}],"}"}],",",RowBox[{"{",RowBox[{"4",",","4"}],"}"}],",",RowBox[
{"{",RowBox[{"4",",","3"}],"}"}],",",RowBox[{"{",RowBox[{"5",",","3"}],"}"}],",",RowBox[
{"{",RowBox[{"6",",","3"}],"}"}],",",RowBox[{"{",RowBox[{"7",",","3"}],"}"}],",",RowBox[
{"{",RowBox[{"7",",","4"}],"}"}],",",RowBox[{"{",RowBox[{"7",",","5"}],"}"}],",",RowBox[
{"{",RowBox[{"7",",","6"}],"}"}],",",RowBox[{"{",RowBox[{"6",",","6"}],"}"}],",",RowBox[
{"{",RowBox[{"5",",","6"}],"}"}],",",RowBox[{"{",RowBox[{"4",",","6"}],"}"}],",",RowBox[
{"{",RowBox[{"3",",","6"}],"}"}],",",RowBox[{"{",RowBox[{"3",",","5"}],"}"}],",",RowBox[
{"{",RowBox[{"3",",","4"}],"}"}],",",RowBox[{"{",RowBox[{"3",",","3"}],"}"}],",",RowBox[
{"{",RowBox[{"3",",","2"}],"}"}],",",RowBox[{"{",RowBox[{"4",",","2"}],"}"}],",",RowBox[
{"{",RowBox[{"5",",","2"}],"}"}],",",RowBox[{"{",RowBox[{"6",",","2"}],"}"}],",",RowBox[
{"{",RowBox[{"7",",","2"}],"}"}],",",RowBox[{"{",RowBox[{"8",",","2"}],"}"}],",",RowBox[
{"{",RowBox[{"8",",","3"}],"}"}],",",RowBox[{"{",RowBox[{"8",",","4"}],"}"}],",",RowBox[
{"{",RowBox[{"8",",","5"}],"}"}],",",RowBox[{"{",RowBox[{"8",",","6"}],"}"}],",",RowBox[
{"{",RowBox[{"8",",","7"}],"}"}],",",RowBox[{"{",RowBox[{"7",",","7"}],"}"}],",",RowBox[
{"{",RowBox[{"6",",","7"}],"}"}],",",RowBox[{"{",RowBox[{"5",",","7"}],"}"}],",",RowBox[
{"{",RowBox[{"4",",","7"}],"}"}],",",RowBox[{"{",RowBox[{"3",",","7"}],"}"}],",",RowBox[
{"{",RowBox[{"2",",","7"}],"}"}],",",RowBox[{"{",RowBox[{"2",",","6"}],"}"}],",",RowBox[
{"{",RowBox[{"2",",","5"}],"}"}],",",RowBox[{"{",RowBox[{"2",",","4"}],"}"}],",",RowBox[
{"{",RowBox[{"2",",","3"}],"}"}],",",RowBox[{"{",RowBox[{"2",",","2"}],"}"}],",",RowBox[
{"{",RowBox[{"2",",","1"}],"}"}],",",RowBox[{"{",RowBox[{"3",",","1"}],"}"}],",",RowBox[
{"{",RowBox[{"4",",","1"}],"}"}],",",RowBox[{"{",RowBox[{"5",",","1"}],"}"}],",",RowBox[
{"{",RowBox[{"6",",","1"}],"}"}],",",RowBox[{"{",RowBox[{"7",",","1"}],"}"}],",",RowBox[
{"{",RowBox[{"8",",","1"}],"}"}],",",RowBox[{"{",RowBox[{"9",",","1"}],"}"}],",",RowBox[
{"{",RowBox[{"9",",","2"}],"}"}],",",RowBox[{"{",RowBox[{"9",",","3"}],"}"}],",",RowBox[
{"{",RowBox[{"9",",","4"}],"}"}],",",RowBox[{"{",RowBox[{"9",",","5"}],"}"}],",",RowBox[
{"{",RowBox[{"9",",","6"}],"}"}],",",RowBox[{"{",RowBox[{"9",",","7"}],"}"}],",",RowBox[
{"{",RowBox[{"9",",","8"}],"}"}],",",RowBox[{"{",RowBox[{"8",",","8"}],"}"}],",",RowBox[
{"{",RowBox[{"7",",","8"}],"}"}],",",RowBox[{"{",RowBox[{"6",",","8"}],"}"}],",",RowBox[
{"{",RowBox[{"5",",","8"}],"}"}],",",RowBox[{"{",RowBox[{"4",",","8"}],"}"}],",",RowBox[
{"{",RowBox[{"3",",","8"}],"}"}],",",RowBox[{"{",RowBox[{"2",",","8"}],"}"}],",",RowBox[
{"{",RowBox[{"1",",","8"}],"}"}],",",RowBox[{"{",RowBox[{"1",",","7"}],"}"}],",",RowBox[
{"{",RowBox[{"1",",","6"}],"}"}],",",RowBox[{"{",RowBox[{"1",",","5"}],"}"}],",",RowBox[
{"{",RowBox[{"1",",","4"}],"}"}],",",RowBox[{"{",RowBox[{"1",",","3"}],"}"}],",",RowBox[
{"{",RowBox[{"1",",","2"}],"}"}]}],"}"}],StandardForm],"Output",CellID->35,CellLabel->"Out[3]= "]},
Open]],Cell[
BoxData[RowBox[{RowBox[{"totals"," ","="," ",RowBox[{"Association","[",RowBox[
{RowBox[{RowBox[{"#"," ","\[Rule]"," ","0"}]," ","&"}]," ","/@"," ","graphCoords"}],"]"}]}],";"," ",RowBox[
{RowBox[{"totals","[",RowBox[{"graphCoords","[",RowBox[{"[","1","]"}],"]"}],"]"}]," ","="," ","1"}],";"}]],
"Input",CellID->300,CellLabel->"In[4]:= "],Cell[
BoxData[RowBox[{RowBox[{"neighborTotals","[","vertex_","]"}]," ",":="," ",RowBox[
{"DeleteCases","[",RowBox[{RowBox[{RowBox[{RowBox[{"totals","[","#","]"}]," ","&"}]," ","/@"," ",RowBox[
{"neighbors","[","vertex","]"}]}],","," ","_Missing"}],"]"}]}]],"Input",CellID->306,
CellLabel->"In[5]:= "],Cell[
CellGroupData[{Cell[
BoxData[RowBox[{RowBox[{RowBox[
{"(",RowBox[{RowBox[{"totals","[","#","]"}]," ","="," ",RowBox[{"Plus"," ","@@"," ",RowBox[
{"neighborTotals","[","#","]"}]}]}],")"}],"&"}]," ","/@"," ","graphCoords"}]],"Input",
CellID->307,CellLabel->"In[6]:= "],Cell[
BoxData[RowBox[{"{",RowBox[{"1",",","1",",","2",",","4",",","5",",","10",",","11",",","23",",","25",",","26",",","54",",","57",",","59",",","122",",","133",",","142",",","147",",","304",",","330",",","351",",","362",",","747",",","806",",","880",",","931",",","957",",","1968",",","2105",",","2275",",","2391",",","2450",",","5022",",","5336",",","5733",",","6155",",","6444",",","6591",",","13486",",","14267",",","15252",",","16295",",","17008",",","17370",",","35487",",","37402",",","39835",",","42452",",","45220",",","47108",",","48065",",","98098",",","103128",",","109476",",","116247",",","123363",",","128204",",","130654",",","266330",",","279138",",","295229",",","312453",",","330785",",","349975",",","363010",",","369601",",","752688",",","787032",",","830037",",","875851",",","924406",",","975079"}],"}"}],
StandardForm],"Output",CellID->37,CellLabel->"Out[6]= "]},Open]],Cell[
CellGroupData[
{Cell[
BoxData[RowBox[{"MatrixForm","[",RowBox[{"SparseArray","[",RowBox[{"Normal","[","totals","]"}],"]"}],"]"}]],
"Input",CellID->313,CellLabel->"In[7]:= "],Cell[
BoxData[TagBox[RowBox[{"(","\[NoBreak]",GridBox[
{{"0","975079","924406","875851","830037","787032","752688","369601"},{"17370","17008","16295","15252","14267","13486","6591","363010"},{"35487","362","351","330","304","147","6444","349975"},{"37402","747","11","10","5","142","6155","330785"},{"39835","806","23","1","4","133","5733","312453"},{"42452","880","25","1","2","122","5336","295229"},{"45220","931","26","54","57","59","5022","279138"},{"47108","957","1968","2105","2275","2391","2450","266330"},{"48065","98098","103128","109476","116247","123363","128204","130654"}},
RowSpacings->1,ColumnSpacings->1,RowAlignments->Baseline,ColumnAlignments->Center],"\[NoBreak]",")"}],
Function[BoxForm`e$,MatrixForm[SparseArray[Automatic,{9,8},0,{1,{{0,7,15,23,31,39,47,55,63,71},{{8},{7},{6},{5},{4},{3},{2},{7},{6},{5},{4},{3},{2},{1},{8},{6},{5},{4},{3},{2},{7},{1},{8},{5},{4},{3},{6},{2},{7},{1},{8},{4},{5},{3},{6},{2},{7},{1},{8},{4},{5},{3},{6},{2},{7},{1},{8},{3},{4},{5},{6},{2},{7},{1},{8},{2},{3},{4},{5},{6},{7},{1},{8},{1},{2},{3},{4},{5},{6},{7},{8}}},{369601,752688,787032,830037,875851,924406,975079,6591,13486,14267,15252,16295,17008,17370,363010,147,304,330,351,362,6444,35487,349975,5,10,11,142,747,6155,37402,330785,1,4,23,133,806,5733,39835,312453,1,2,25,122,880,5336,42452,295229,26,54,57,59,931,5022,45220,279138,957,1968,2105,2275,2391,2450,47108,266330,48065,98098,103128,109476,116247,123363,128204,130654}}]]]],
StandardForm],"Output",CellID->39,CellLabel->"Out[7]//MatrixForm= "]},Open]],Cell[
BoxData[
""],"Input",CellID->5,CellLabel->"In[8]:= "],Cell[
CellGroupData[{Cell[
BoxData[RowBox[
{"SelectFirst","[",RowBox[{"totals",","," ",RowBox[{RowBox[{"#"," ",">"," ","700000"}],"&"}]}],"]"}]],
"Input",CellID->26,CellLabel->"In[9]:= "],Cell[
BoxData["752688",StandardForm],"Output",
CellID->41,CellLabel->"Out[9]= "]},Open]]},StyleDefinitions->"Default.nb",FrontEndVersion->"10.0 for Wolfram Cloud Platform (June 2 2014)"]